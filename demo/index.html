<html>
  <head>
    <meta charset="utf-8">
    <title>Map generation demo</title>
    <link rel="stylesheet" href="style.css">
  </head>
  <body>
    <h1>Map generation<small> - work in progress</small></h1>
    <p>Walls are grey bricks, floor is coloured pavement.</p>

    <div id="grid">
      <div id="rooms"></div>
    </div>

    <button id="toggleRooms">Show/hide rooms overlays</button><code id="position">&nbsp;</code>


    <pre>
[X] - Generating random map
[X] - Cleaning up the map (isolated 1x1 cells)
[X] - Find rooms
[X] - Extra room cleanup (remove small rooms)
[X] - Find rooms boundaries
[ ] - Create pathes between rooms
[ ] - Place random objects
[X] - Render the map
</pre>

    <script src="https://code.jquery.com/jquery-1.12.3.min.js" integrity="sha256-aaODHAgvwQW1bFOGXMeX+pC4PZIPsvn2h1sArYOhgXQ=" crossorigin="anonymous"></script>
    <script src="../js/mapgen.js" type="text/javascript"></script>
    <script src="../js/room_samples.js" type="text/javascript"></script>
    <script>

    // Generating the map
    var map=new MapGen;
    map.createMap();
    //map.createMapFromSample(samples[0]);
    map.createRooms();
    map.removeSmallRooms(50);
    map.createPaths();
    map.jQueryRender('#grid');


    // Rooms overlays... May be included in the class.
    for(let i in map.rooms){
      $('#rooms').append('<div class="'+map.cssPrefix+'room '+map.cssPrefix+'room-'+map.rooms[i].id+'-overlay" style="top:'+(map.rooms[i].box.yMin*7)
      +'px; left:'+(map.rooms[i].box.xMin*7)
      +'px; width:'+((map.rooms[i].box.xMax-map.rooms[i].box.xMin+1)*7)
      +'px; height:'+((map.rooms[i].box.yMax-map.rooms[i].box.yMin+1)*7)
      +'px"><h2>'+map.rooms[i].id+'</h2>'+(map.rooms[i].box.yMax-map.rooms[i].box.yMin)+' x '+(map.rooms[i].box.yMax-map.rooms[i].box.yMin)+'</div>')
    }
    $('#rooms').hide();
    $('#toggleRooms').click(function(){
      $('#rooms').toggle();
    })

    $('.map-cell').hover(function(a){
      $('#position').text($(this).attr('class'))
    });
    </script>
  </body>
</html>
