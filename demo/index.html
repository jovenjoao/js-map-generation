<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Map generation demo</title>
    <link rel="stylesheet" href="style.css" type="text/css">
  </head>
  <body>
    <div id="main">
      <h1>Map generation<small> - work in progress</small></h1>
      <p>Walls are grey bricks, floor is coloured pavement.</p>

      <div id="grid">
        <div id="rooms"></div>
        <!-- Canva for pathes will go here -->
      </div>

      <div id="menu">
        <pre class="info">&gt;<span id="position"></span></pre>
        <button id="toggleRooms">Show/hide rooms bounding boxes</button>
        <button id="togglePathes">Show/hide pathes</button>
        <button id="toggleRoomLimits" disabled>Show/hide rooms frontiers</button>
      </div>


<pre>
  [X] - Generating random map
  [X] - Cleaning up the map (isolated 1x1 cells)
  [X] - Find rooms
  [X] - Extra room cleanup (remove small rooms)
  [X] - Find rooms boundaries
  [X] - Find all possible pathes (from rooms virtual centers)
  [ ] - Create pathes between rooms
  [X] - Place random objects
  [X] - Render the map
</pre>
  </div>

    <script src="https://code.jquery.com/jquery-1.12.3.min.js" integrity="sha256-aaODHAgvwQW1bFOGXMeX+pC4PZIPsvn2h1sArYOhgXQ=" crossorigin="anonymous"></script>
    <script src="../js/mapgen.js" type="text/javascript"></script>
    <script src="../js/mapgen-objects.js" type="text/javascript"></script>
    <script src="../js/mapgen-privates.js" type="text/javascript"></script>
    <script src="../js/mapgen-methods.js" type="text/javascript"></script>
    <script src="../js/demo_functions.js" type="text/javascript"></script>
    <script src="../js/demo_base_objects.js" type="text/javascript"></script>
    <script src="../js/demo_room_samples.js" type="text/javascript"></script>
    <!--<script src="../build.js" type="text/javascript"></script>
    <script src="../build-demo.js" type="text/javascript"></script>-->
    <script type="text/javascript">

    var map=null;
    var options={
      // Options for the map generator
      mapOptions:{
        x:5,
        y:5,
        passes:3,
        cleanLevel: 5,
        wallPercent:30,
        // Cell types are defined in demo.js
        cellTypes: cellTypes,
      }
    }

    createAndRenderMap(options);


    /***************************************************************************
      JQuery
    */
    $('#rooms').hide();
    $('#map-pathes').hide();
    /**
      Events on buttons
    */
    $('#toggleRooms').click(function(){
      $('#rooms').toggle();
    })
    $('#togglePathes').click(function(){
      $('#map-pathes').toggle();
    })

    $('.map-cell').hover(function(a){
      $('#position').text($(this).attr('class'))
    });

    // Tooltips. (base from http://www.alessioatzeni.com/blog/simple-tooltip-with-jquery-only-text/)
    $(document).ready(function() {
      // Tooltip only Text
      $('.map-cell').hover(function(){
        // Hover over code
        var cellId = $(this).attr('title');
        var content='Cell :'+displayData(map.cells[cellId])+'Content:' +displayData(map.items[map.getCellContent(cellId)]);
        $(this).data('tipText', cellId).removeAttr('title');
        $('<p class="tooltip"></p>').html(content).appendTo('body').fadeIn('slow');}, function() {
          // Hover out code
          $(this).attr('title', $(this).data('tipText'));
          $('.tooltip').remove();
        }).mousemove(function(e) {
          var mousex = e.pageX + 20; //Get X coordinates
          var mousey = e.pageY + 10; //Get Y coordinates
          $('.tooltip').css({ top: mousey, left: mousex });
        });
      });
    </script>
  </body>
</html>
